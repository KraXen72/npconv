<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>NewPipe ⇌ LibreTube Backup Converter</title>

	<!-- Bundled JS will include dependencies (jszip, sql.js) -->
</head>

<body>
	<div class="container">
		<h1>NewPipe ⇌ LibreTube Backup Converter</h1>

		<div class="mode-selector">
			<div class="mode-switch" role="tablist" aria-label="Mode selector">
				<input type="radio" id="mode-merge" name="mode" value="merge" checked onchange="updateUI()">
				<label for="mode-merge" class="mode-pill">Merge</label>
				<input type="radio" id="mode-convert" name="mode" value="convert" onchange="updateUI()">
				<label for="mode-convert" class="mode-pill">Convert</label>
			</div>
		</div>

		<div class="global-option">
			<label for="include-watch-history">Include watch history:</label>
			<input type="checkbox" id="include-watch-history" checked />
		</div>

		<!-- Merge controls (visible when merge selected) -->
		<div id="merge-controls" class="controls-block">
			<div class="merge-options">
				<label for="playlist-behavior">Playlists handling:</label>
				<select id="playlist-behavior">
					<option value="merge_np_precedence">Merge playlists (NewPipe precedence)</option>
					<option value="merge_lt_precedence">Merge playlists (LibreTube precedence)</option>
					<option value="only_newpipe">Only NewPipe playlists</option>
					<option value="only_libretube">Only LibreTube playlists</option>
				</select>
			</div>



			<div class="direction-toggle">
				<span class="dir-label">NewPipe</span>
				<label class="two-way">
					<input type="checkbox" id="merge-direction" aria-label="Merge direction" />
					<span class="slider" aria-hidden="true">
						<!-- Arrow icon; will rotate via CSS to indicate direction -->
						<svg class="toggle-arrow" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13a1 1 0 0 0-1-1H5.061a1 1 0 0 1-.75-1.811l6.836-6.835a1.207 1.207 0 0 1 1.707 0l6.835 6.835a1 1 0 0 1-.75 1.811H16a1 1 0 0 0-1 1v6a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1z"/></svg>
					</span>
				</label>
				<span class="dir-label">LibreTube</span>
			</div>

			<div class="controls">
				<button id="btn-merge">Merge</button>
			</div>
		</div>

		<!-- Convert controls (visible when convert selected) -->
		<div id="convert-controls" class="controls-block" style="display:none;">
			<div class="controls">
				<button id="btn-to-newpipe" onclick="processBackup('to_newpipe')">Target: NewPipe</button>
				<button id="btn-to-libretube" onclick="processBackup('to_libretube')">Target: LibreTube</button>
			</div>


		</div>

		<div class="file-area">
			<div class="drop-zone" id="zone-newpipe" role="button" tabindex="0" aria-label="Select NewPipe backup">
				<h4>NewPipe Backup (.zip)</h4>
				<p><small class="hint">Contains newpipe.db<br>click/drop file to upload</small></p>
				<input type="file" id="file-newpipe" accept=".zip">
				<div class="file-name" aria-live="polite"></div>
			</div>

			<div class="drop-zone" id="zone-libretube" role="button" tabindex="0" aria-label="Select LibreTube backup">
				<h4>LibreTube Backup (.json)</h4>
				<p><small class="hint">JSON export file<br>click/drop file to upload</small></p>
				<input type="file" id="file-libretube" accept=".json">
				<div class="file-name" aria-live="polite"></div>
			</div>
		</div>

		<h3>Debug Log</h3>
		<div id="debug-console">waiting for input...</div>
	</div>
	<script type="module" src="/src/main.ts" defer></script>
</body>

</html>